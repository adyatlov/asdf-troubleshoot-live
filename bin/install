#!/usr/bin/env bash

# Check if Go is installed
if ! command -v go >/dev/null; then
    echo "Error: Go is not installed. Please install Go before using this plugin."
    exit 1
fi

# Check Go version
GO_VERSION=$(go version | awk '{print $3}')
REQUIRED_GO_VERSION="go1.20"
if [[ "$GO_VERSION" < "$REQUIRED_GO_VERSION" ]]; then
    echo "Error: Go version $REQUIRED_GO_VERSION or newer is required. Current version: $GO_VERSION"
    exit 1
fi

# Download, build, and install your CLI tool
GOBIN="$ASDF_INSTALL_PATH/bin" go install "github.com/mhrabovcin/troubleshoot-live@v$ASDF_INSTALL_VERSION"

# Exit with success status
exit 0
